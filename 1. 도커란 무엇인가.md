# 도커란 무엇인가?



## 목차

1. 서버를 관리한다는 것
2. 서버관리 방식의 변화
3. 도커의 등장
4. 도커란

------



## 1. 서버를 관리한다는 것

### 겉으로 볼때는 간단해보인다.

그러나 실제로는 수 많은 관계를 가진 것들이 동시에 동작하고, 요소들 중 하나만 동작하지 않아도 서버는 제대로 동작하지 않을 수 있다.

오라클이나, GitLab등을 설치할 때 메뉴얼을 보고 따라하는 경우가 많다. 그러나 메뉴얼이 오래되었거나, 화면은 떳지만 로그인이 되지 않는 등 여러가지 이유로 설치가 제대로 되지 않을 수 있다.

또한 AWS, Azure 등 인프라 환경이 계속해서 변경될 수 있다.



## 2. 서버관리 방식의 변화

![서버_관리_방식_변화1.png](./image/서버_관리_방식_변화1.png)

기존에는 유저를 추가하고 환경변수를 바꾸고, 파이썬을 설치하고... 등

서버 관리자가 한땀한땀 **순서대로 필요한 작업을 수행**하는 것에 익숙해져 있었다.

![서버_관리_방식_변화2.png](./image/서버_관리_방식_변화2.png)

도커가 등장하면서 모든 것이 추상화되었다.

어떠한 프로그램도 공통적인 형태인 컨테이너로 만들 수 있고, AWS, Azure 등 어디서든 컨테이너를 실행 할 수 있다.

컨테이너는 가상머신처럼 독립적으로 실행되지만, 가상머신 보다 빠르고, 쉽고, 효율적으로 동작한다.



## 3. 도커의 등장

### 서버의 상태를 관리하기 위한 노력

1. 프로그램을 설치하기 위한 문서: 굉장히 세부적인 설명, 스크린샷 등..
   - 문제점
     - 이 문서가 정확한가?
     - 다른 운영체제에서는 어떻게 설치하는가?
     - 문서가 오래된 경우
     - 똑같이 했는데 안되는 경우
     - 문서를 업데이트 후 공유하지 않는 경우
2. 상태관리 도구 도입: CHEF, PUPPET, ANSIBLE 등 문서화 → 설정파일로 관리
   - 문제점
     - 러닝커브가 크다.
     - 운영체제마다 사용 방법이 다르다.
     - 한 서버에 같은 프로그램을 여러 버전으로 설치하고 싶은 경우 난이도가 높다.
3. 가상 머신
   - 문제점
     - 처음부터 다시 세팅하는 경우 초기 정보를 알고 있어야 한다. (결과는 보장되지만 과정은 보장되지 않는다.)
     - 이미지 공유가 어렵다.
     - 느리다.
4. 자원 격리
   - 프로세스를 가상으로 격리한다.
   - 파일, 디렉토리를 가상으로 분리한다.
   - CPU, MEMORY, I/O 등을 그룹별로 제한한다.
   - 문제점
     - 위와 같은 리눅스의 기술을 적용하기 너무 어렵다.
5. 도커의 등장
   - 어렵고 복잡한 기술을 사용하기 쉽게 해준다.
   - 2013년 DotCloud에서 공개했다.
   - 도커는 컨테이너 기술을 사용한다.
     - 격리된 환경에서 작동하는 프로세스
     - 리눅스 커널의 여러 기술을 활용한다.
     - 하드웨어 가상화 기술보다 가볍다.
     - 이미지 단위별로 프로세스 실행 환경을 구성한다.

## 도커란

![가상머신vs도커.png](./image/가상머신vs도커.png)

- VM의 Guest OS, Hypervisor 등 리눅스를 사용하기 위한 환경이 오버헤드가 된다.
- 도커는 위와 같은 오버헤드가 발생하지 않는다.

### 도커의 특징

- 확장성과 이식성
  - 도커가 설치되어 있다면 어디서든 컨테이너를 실행할 수 있다.
  - 특정 회사나 서비스에 종속적이지 않다.
    - 오픈소스이다.
  - 쉽게 개발서버를 만들 수 있고, 테스트서버 생성도 간편하다.
- 표준성
  - 도커를 사용하지 않는 경우 ruby, node, go, php 등 배포 방식이 모두 다르다.
  - 컨테이너라는 표준으로 서버를 배포하므로 모든 서비스의 배포 과정이 동일해진다.
- 이미지
  - 이미지에서 컨테이너를 생성하기 때문에 반드시 이미지를 만드는 과정이 필요하다.
  - Dockerfile을 이용하여 이미지를 만들고 처음부터 재현이 가능하다.
  - 빌드 서버에서 이미지를 만들면 해당 이미지를 저장소에 저장하고 운영서버에서 이미지를 불러온다.
- 설정관리
  - 설정은 보통 환경변수로 제어한다.
  - MYSQL_PASS=password 와 같이 컨테이너를 띄울때 환경변수를 같이 지정 가능하다.
  - 하나의 이미지가 환경변수에 따라 동적으로 설정파일을 생성하도록 만들어져야한다.
- 자원관리
  - 컨테이너는 삭제 후 새로 만들면 모든 데이터가 초기화된다.
  - 업로드 파일을 외부 스토리지와 링크하여 사용하거나 S3같은 별도의 저장소가 필요하다.
  - 세션이나 캐시를 memcached나 redis 같은 외부에 분리해야 한다.

### 도커의 장점

- 이미지를 관리하기 쉽다.
- 다른 프로세스와 격리되어 가상머신처럼 사용하지만 성능저하가 거의 없다.
- 복잡한 기술(namespace, cgroups, network 등)을 몰라도 사용할 수 있다.
- 이미지 빌드 기록이 남는다.
  - dockfile 등을 git으로 관리할 수 있다.
- 코드와 설정으로 관리하여 재현 및 수정이 용이하다.
- 오픈소스이기 때문에 특정 회사나 기술에 종속적이지 않다.